<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>JavaFX Google Map</title>

    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCqbKdjkod9FVs371m7I4Vv3B7opV2xfWI&libraries=places"></script>

    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
        #map {
            height: 100%;
            width: 100%;
        }
    </style>

    <script>
        let map, directionsService, directionsRenderer, markers = [];

        function initMap() {
            const center = { lat: 23.79870, lng: 90.44985 }; // UIU location

            map = new google.maps.Map(document.getElementById("map"), {
                center: center,
                zoom: 15,
                mapTypeId: "roadmap"
            });

            directionsService = new google.maps.DirectionsService();
            directionsRenderer = new google.maps.DirectionsRenderer({ map: map });

            new google.maps.Marker({
                position: center,
                map: map,
                title: "United International University"
            });
        }

        // Clear all existing markers
        function clearMarkers() {
            for (let m of markers) m.setMap(null);
            markers = [];
        }

        // Add marker by searching a place name
        function addMarkerByName(name) {
            const service = new google.maps.places.PlacesService(map);
            const request = { query: name, fields: ["name", "geometry"] };

            service.findPlaceFromQuery(request, function(results, status) {
                if (status === google.maps.places.PlacesServiceStatus.OK && results[0]) {
                    const loc = results[0].geometry.location;
                    const marker = new google.maps.Marker({
                        position: loc,
                        map: map,
                        title: name
                    });
                    markers.push(marker);
                }
            });
        }

        // Draw a polyline route using a list of bus stand names
        function drawRouteByNames(names) {
            const service = new google.maps.places.PlacesService(map);
            const coords = [];
            let i = 0;

            function next() {
                if (i >= names.length) {
                    if (coords.length > 1) {
                        new google.maps.Polyline({
                            path: coords,
                            geodesic: true,
                            strokeColor: "#FF5722",
                            strokeOpacity: 1.0,
                            strokeWeight: 4,
                            map: map
                        });
                    }
                    return;
                }

                const req = { query: names[i++], fields: ["geometry"] };
                service.findPlaceFromQuery(req, function(results, status) {
                    if (status === google.maps.places.PlacesServiceStatus.OK && results[0]) {
                        coords.push(results[0].geometry.location);
                    }
                    next();
                });
            }
            next();
        }

        // Draw actual transit route between two points
        function calculateRoute(origin, destination, transitMode) {
            const request = {
                origin: origin,
                destination: destination,
                travelMode: google.maps.TravelMode.TRANSIT,
                transitOptions: { modes: [transitMode] }
            };

            directionsService.route(request, (response, status) => {
                if (status === "OK") {
                    directionsRenderer.setDirections(response);
                } else {
                    alert("Directions request failed: " + status);
                }
            });
        }

        window.onload = initMap;
    </script>
</head>
<body>
<div id="map"></div>
</body>
</html>
